# 7. 系统测试

## 7.1 概述

**系统测试** (System Testing) 指软件投产以前，接近于日常测试的综合性检验测试。完成集成测试后，需要按照需求说明书对系统进行测试。采用 **黑盒测试** 方法进行测试。  

系统测试包含：  

* **功能测试**
* **性能测试**
* 负载测试
* 强度测试
* 容量测试
* 安全性测试
* **配置测试**
* 故障恢复测试
* **安装测试**
* 文档测试
* 用户界面测试
* etc.

其中加粗为必需测试，其他可以根据软件项目的具体要求进行裁剪。  

## 7.2 功能测试

### 7.2.1 功能测试概述

**功能测试** (Function Testing) 又称 **正确性测试** ，是指在规定的一段时间内运行软件系统的所有功能，以验证这个软件系统有无严重错误，即测试软件系统的功能是否正确。  
由于正确性是软件最重要的质量因素，故功能测试是软件测试中不可或缺的重要测试内容之一。

* 功能测试在单元测试和集成测试阶段都有涉及。
* 单元测试说明了 **代码执行** 是否正确。  
* 功能测试说明了 **功能** 是否正确。
* 单元测试中的功能测试从 **代码开发人员** 的角度来编写。  
* 系统测试中的功能测试从 **最终用户和业务流程** 的角度来编写。

功能测试的大部分工作都还是在系统集成测试完成后的系统测试阶段进行的，因为这时系统的功能稳定且完整。

针对不同的应用系统，功能测试的测试内容的差异很大，但一般可归为界面、数据、操作、逻辑、接口等几个方面：  

* 程序安装、启动正常，有相应的提示框、适当的错误提示等。  
* 每项功能符合实际要求。  
* 子系统的界面清晰、美观。  
* 菜单、按钮操作正常、灵活，能处理一些异常操作。  
* 能接受正确的数据输入，对异常数据的输入可以进行提示、容错处理等。  
* 数据的输出结果准确，格式清晰，可以保存和读取。  
* 功能逻辑清楚，符合使用者习惯。  
* 子系统的各种状态按照业务流程而变化，并保持稳定。  
* 支持各种应用的环境，能配合多种硬件周边设备，与外部应用系统的接口有效。  

### 7.2.2 功能测试流程

* 测试需求分析
  * 测试需求是用来识别何种内容需要进行测试。  
  * 测试需求通常需要覆盖一些 **业务规则** ，**功能** 以及 **非功能** 的内容，不需要有实际的测试数据出现。
* 制定测试计划
* 测试设计和测试用例设计
* 测试环境搭建
* 测试实施
* 缺陷报告
* 回归测试

**业务需求** 通常是指系统需要做什么。  
**测试需求** 除了需要覆盖系统应该做什么外，还要覆盖系统不应该做什么。  

> 业务需求：  
>  
> * ATM 能进行取款。  
> * 如每次取款额度在 50-2,500 之间。  
> * 取款的金额是 50 的倍数。  
> * 从 ATM 机器上每日取款数量不得超过 20,000。  
>  
> 测试需求：  
>  
> * 取款按钮是可选的。  
> * 在 50-2,500 之间的 50 的倍数是可取的。  
> * 小于 50 元是不允许的。  
> * 大于 2,500 是不允许的。  
> * 50 的倍数但是大于 2,500 是不允许的。  
> * 在 50-2,500 之间但不是 50 的倍数是不允许的。  
> * 收到的金额与请求的金额相当。  
> * 取款的总额必须是小于等于账户余额。  

## 7.3 回归测试

**回归测试** 保证所做的修改达到了预定的目的，如错误得到了改正，新功能得到了实现，能够适应新的运行环境等。
回归测试不影响软件原有功能的正确性。  

> 一旦程序某些区域被修改了，就可能影响其它区域，导致受影响的区域出现新的缺陷（回归缺陷）。  
> 如果这时没有回归测试，产品就带着这样的回归缺陷被发布出去了，造成严重后果。回归测试就是为了发现回归缺陷而进行的测试。

## 7.4  性能测试

**性能测试** (performance test) 是为发现系统性能问题或获取系统性能相关指标而进行的测试。  
一般在真实环境、特定负载条件下，通过工具模拟实际软件系统的运行及操作。同时监控性能各项指标，最后对测试结果行分析来确定系统的性能状况。  

* **狭义的性能测试**
  主要用于描述常规的性能测试，是指通过模拟真实的业务压力或用户使用场景来测试系统的性能是否满足用户的性能要求。  
* **广义的性能测试**
  是压力测试、负载测试、强度测试、并发用户测试、大数据量测试、配置测试、可靠性测试等和性能相关的测试统称。  

**性能** 是描述软件系统硬件成本与时间成本的指标。  

通常，衡量一个软件系统性能的常见指标有：  

* **响应时间** (Response time)
  用户感受软件系统为其服务所耗费的时间。
  可以细分为：  
  * **服务器端响应时间**
  服务器完成交易请求执行的时间，不包括客户端到服务器端的反应（请求和耗费在网络上的通信时间），这个服务器端响应时间可以度量服务器的处理能力。  
  * **网络响应时间**
  网络硬件传输交易请求和交易结果所耗费的时间。
  * **客户端响应时间**
  这是客户端在构建请求和展现交易结果时所耗费的时间。
* **吞吐量** (Throughput)
  软件系统在每单位时间内能处理多少个 **事务** / **请求** / **单位** 数据等。  
  可以细分为：  
  * **数据库吞吐量**
  单位时间内，不同 SQL 语句的执行数量。  
  * **网络吞吐量**
  单位时间内在网络上传输的数据流量。  
  吞吐量的大小由负载（如用户的数量）或行为方式来决定。  
  如 下载文件比浏览网页需要更高的网络吞吐量。  
* **资源使用率** (Resource utilization)
  * CPU 占用率
  * 内存使用率
  * 磁盘 I/O
  * 网络 I/O
* **点击数** (Hits per second)
  客户端向 Web Server 发起的 http 请求次数。  
* **并发用户数** (Concurrent users)
  一定时间内，某个某个时刻与服务器同时进行会话操作的用户数。  
* etc.

性能测试用于：  

* 识别系统瓶颈和产生瓶颈的原因。  
* 最优化和调整平台的配置（包括硬件和软件）来达到最高的性能。  
* 判断一个新的模块是否对整个系统的性能有影响。  

常见的性能测试方法有以下几种：

* **负载测试**
  * 对系统不断施加压力或增加一定压力下的持续时间，直到系统的某一性能指标达到极限。  
  * 例如响应时间超过预定的指标或某种源已经达到饱和状态。  
  * 这种测试可以找到系统处理的极限，对系统调优提供依据。  
  * 负载测试关心的是 **用户规则和需求** 。
* **压力测试**
  * 对系统不断施加压力的测试，是通过确定一个系统的瓶颈或不能接受用户请求的性能点，来获得系统能提供的最大服务级别的测试。  
  * 考察系统在极端条件下的表现。此极端条件并不一定是用户的性能需求，可能要远远高于用户的性能需求。  
  * 如 测试一个 WEB 站点在大量的负荷下，系统的事务响应时间何是会变得不可接受或事务不能正常执行。
  * 压力测试侧重压力的大小，而负载测试往往强调压力持续的时间。  
  * 压力测试关心的是 **软件系统本身** 。  
* **并发测试**
  * 测试多个用户并同时访问同一个应用程序、同一个模块或数据记录时是否存在死锁或其他性能问题。  
  * 并发测试验证系统的并发处理能力。一般是和服务器端建立大量的并发连接，通过客户端的响应时间和服务器端的性能监测情况来判断系统是否达到了既定的并发能力指标。  
* 强度测试
  * 检查程序对异常情况的抵抗能力。  
  * 强度测试总是迫使系统在异常的资源配置下运行。  
* 可靠性测试
  * 在给系统加载一定业务压力的情况下，使系统运行一段时间，以检测系统是否稳定。
* 基准测试
  * 当软件系统中增加一个新的模块的时候，需要做基准测试，以判断新模块对整个软件系统的性能影响。  
  * 关闭模块之前的系统各个性能指标记下来作为基准 (Benchmark) ，然后与打开模块状态下的系统性能指标作比较，以判断模块对系统性能的影响。
  * 按照基准测试的方法，需要打开 / 关闭新模块至少各做一次测试。
* 稳定性测试
  * 测试系统在一定负载下运行长时间后是否会发生问题。  
* 可恢复测试
  * 测试系统能否快速地从错误状态中恢复到正常状态。  

> * 一般性能测试：
>   背 1 袋米。
> * 稳定性测试：
>   让他背 1 袋米，但是让他去操场上跑圈，看要多少时间会累倒。
> * 负载测试：
>   背 3 袋米去操场上跑圈，看多少时间会累倒
> * 压力测试：
>   让他背 2 袋米，3 袋米，4 袋米……
>   发现他最多就能背 3 袋米。

## 7.5 Web 测试

基于 Web 的软件架构系统的测试与传统的软件测试不同。  

* 需要检查和验证网站是否按照设计的要求运行。  
* 要测试网站是否适合不同用户的浏览器显示。  
* 要从最终的使用用户的角度进行安全性和可用性的各项测试。  

Web 错误与运行环境息息相关，往往在不同平台上不能复现。  

### 7.5.1 用户界面测试

#### 导航测试

导航描述了用户在不同的连接页面之间跳转的方式。  
导航测试需要考虑下列问题：  

* 导航是否直观？
* Web 系统的主要部分是否可通过主页存取？
* Web 系统是否需要站点地图、搜索引擎或其它的导航帮助？
* Web 应用系统的页面结构、导航、菜单、连接的风格是否不一致？
* 确保用户凭直觉就知道 Web 应用系统里面是否还有内容？内容在什么地方？

#### 图形测试

图形测试需要考虑下列问题：  

* 检测是否所有图形都正确载入和显示了。
* 确保图形有明确的用途，图片或动画不能胡乱地堆放在一起，以免浪费传输时间。
* 图片的大小和质量是重要的因素，一般采用 JPG 或 GIF 压缩。图片尺寸应小，但又能清楚地说明某件事情。
* 验证所有页面字体的风格是否一致。
* 背景颜色应该与字体颜色和前景颜色相搭配。
* 窗口大小对图片和文字排版的影响。

#### 内容测试

网页内容可以看做是软件文档，可以用测试文档的方法进行测试。
检查用户等级、术语、内容以及题目素材、拼写、准确度（特别是可能过期的信息）、网页标题栏、版权声明、替代文字 (Alt text) 、日期、联系信息等。  

### 7.5.2 功能测试

#### 链接测试

链接是 Web 页的一个主要特征，它是在页面之间跳转与指导用户去一些其他地址的主要手段。  

链接测试可分为三个方面：

* 测试所有链接是否按指示链接到了该链接的页面。
* 测试所链接的页面是否存在。
* 保证网站上没有孤立的页面（没有链接指向该页面，只能通过正确的 URL 地址才能访问）。  
* 超链接的外观应合理。  

#### 表单测试

表单指网页上用于输入和选择信息的文本框、列表框和其它域。

表单测试检测域的大小是否正确，数据接受是否正确，可选域是否真正可选等等。
用常规黑盒测试方法测试表单，如大小，数据处理，错误处理，边界值等。

#### 数据库测试

* **数据一致性故障**
  主要由用户提交的表单信息不正确而引起。
* **输出故障**
  主要由网络速度或程序设计等问题引起。

### 7.5.3 性能测试

#### 服务器性能测试和加载测试

#### 配置和兼容性测试

测试网站需要考虑可能会影响网站运行和外观的硬件和软件配置。  

* 硬件平台
* 浏览器软件和版本
* 浏览器选项
* 浏览器插件
* 视频分辨率和色深
* 文字大小
* 网络速率

兼容性包括：  

* 平台兼容性
  在 Web 系统发布前，需要在各种操作系统下对Web系统进行兼容性测试。
* 浏览器兼容性
  浏览器是 Web 客户端的核心构件，需要在不同的浏览器上进行兼容性测试。
* 分辨率兼容性
  对于常见的分辨率，必须保证测试通过。  
* 组合兼容性。
  理想的情况下，系统能在所有的机器上运行，所以要进行组合测试。
  
#### 安全性测试

* 用户身份认证
  必须测试有效和无效的用户名和密码，检测是否可以不登陆而直接浏览某个页面等。
* 会话时间控制
  检测网页是否有超时的限制。
* 信息是否外泄
  当使用了安全套接字时，检测加密是否正确，信息是否完整。
* 服务器端安全漏洞
  检测在服务器端放置和编辑脚本等问题。  
