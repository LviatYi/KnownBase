# 3. 黑盒测试

黑盒测试中，测试者在不考虑程序内部的实现的前提下，对程序接口进行测试。  

黑盒测试只检查程序功能是否能按照需求规格说明书的规定正确使用。  

## 3.1 边界值测试

### 3.1.1 边界条件

**边界条件** 在条件 $C$ 下，软件执行一种操作，对任意小的值 $\sigma$ ，条件 $C+\sigma$ 或 $C-\sigma$ 会执行另外的操作，则 $C$ 是一个边界。  

一般地，边界值可从常识或规格说明书得到。  

#### 3.1.1.1 内部边界条件

在软件测试用例测试过程中，某些边界条件不需要呈现给用户，或者说用户很难注意到，但属于检验范畴内的边界条件，称为 **内部边界条件** 或 **次边界条件** 。  

内部边界条件主要分为以下几种：  

* **数值边界值** 例如 int 类型，在 $-2^{31}+1 \sim 2^{31}$ 之间。  
* **字符边界值** 例如 Acsii 码值。  
* **其他边界条件**  
  * 空值后确认  
  * 默认值  
  * 空白值（多个空格）  
  * 0 值  

#### 3.1.1.2 边界值取值

一般地，确定边界值有以下几条原则。  

1. 若有范围，则取这个范围的边界的值，以及各个超越这个范围边界的值。  
2. 若输入条件规定了值的个数，则取最大个数，最小个数，最大个数 - 1 ，最小个数 + 1 。  
3. 若程序的规格说明给出的输入域或输出域是有序集合，则取集合的第一个元素和最后一个元素。  
4. 若程序中使用了一个内部数据结构，则应当选择这个内部数据结构的边界值。  
5. 分析规格说明，找出其他可能的边界条件。  

### 3.1.2 边界值分析

取输入变量的最小值，略大于最小值，正常值，略小于最大值，最大值。  
通常它们表示为 ```min``` , ```min+``` , ```nom``` , ```max-``` , ```max``` 来表示。  

若程序有多个输入变量，需要考虑如何组合各变量的取值。  

* **单缺陷假设** 假设失效极少由于多个缺陷同时发生引起的。  
* **多缺陷假设** 假设失效是由多个缺陷同时发生引起的。  

一般在边界值分析中，使用单缺陷假设。  

> 若 $a \in [0 , 10],b \in [10 , 20]$ 则取  
> $\{<0,15> , <1,15> , <9,15> , <10,15> , <5,10> , <5,11> , <5,19> , <5,20> , <5,15>\}$

### 3.1.3 健壮性边界测试

健壮性（鲁棒性）是指在异常情况下，软件还能正常运行的能力。健壮性可衡量软件对于规范要求以外的输入情况的处理能力。  

取输入变量的最小值，略大于最小值，正常值，略小于最大值，最大值。  
通常它们表示为 ```min-``` , ```min``` , ```min+``` , ```nom``` , ```max-``` , ```max``` , ```max+``` 来表示。  

> 若 $a \in [0 , 10],b \in [10 , 20]$ 则取  
> $\{<-1,15> , <0,15> , <1,15> , <9,15> , <10,15> , <11,15> , <5,9> , <5,10> , <5,11> , <5,19> , <5,20> , <5,21> , <5,15>\}$

### 3.1.4 最坏情况测试

取输入变量的最小值，略大于最小值，正常值，略小于最大值，最大值。  
通常它们表示为 ```min-``` , ```min``` , ```min+``` , ```nom``` , ```max-``` , ```max``` , ```max+``` 来表示。  

最坏情况测试采用 **多缺陷假设** ，即它关心多个变量取极值时出现的情况。因此对于 $n$ 个变量的函数，会产生 $5^n$ 个测试用例。  

> 若共两个输入变量，则最坏情况测试产生 25 个测试用例。  

## 3.2 等价类测试

### 3.2.1 等价类

#### 3.2.1.1 等价类的划分

等价类划分是将输入定义域进行划分，并且划分的各个子集是由等价关系决定的。这里的等价关系是指：在子集中，各个输入数据对于揭露程序程序中的错误都是等效的。且做如下合理假设：测试某等价类的代表值就等于对这个类中其它值的测试。  

等价类划分有两种不同情况：  

* 有效等价类  
* 无效等价类

#### 3.2.1.2 划分方法

* **按照区间划分** 在输入条件规定了取值范围或值的个数的情况下，可以确立一个有效等价类和两个无效等价类。  
* **按照数值划分** 规定了一组 n 个输入数据，则可以确定 n 个有效等价类和一个无效等价类。  
* **按照数值集合划分** 规定了「必须如何」的规则，则可以确定一个有效等价类和一个无效等价类。例如「以字母开头」和「以非字母开头」。  
* **布尔划分** 规定了输入条件是一个布尔值，则可以确定一个有效等价类和一个无效等价类。  
* **进一步细分等价类** 在确定已划分的等价类中各元素在程序处理中的方式不同的情况下，则应再将该等价类进一步划分为更小的等价类。  
* **其他划分** 默认值，空白值，NULL， 0 值等。  

#### 3.2.1.3 等价类的特点

* **完备性** 划分出的各个等价类（子集）的并集是输入/输出的全集，即程序的定义域/值域。  
* **无冗余性** 各个等价类是互不相交的一组子集。  
* **等价性** 划分的各个子集是有等价关系决定的。因此只要选择等价类中具有代表性的一组数据即可达到测试目的。  
