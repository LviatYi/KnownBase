# 0. 概述

## 0.1 什么是编译

编译的本质是翻译的过程，即分析源语言，根据句子的语义翻译为目标语言，而目标语言与源语言在逻辑上是 **等价的** 。

> ![compilerInProcessSystem](../pic/compilerInProcessSystem.svg "编译器在语言处理系统中的位置")
>
> - 预处理器 (Preprocessor)
>   - 把存储在不同文件中的源程序聚合在一起。
>   - 把被称为宏的缩写语句转换为原始语句。
> - 可重定位 (Relocatable) 指在内存中存放的起始位置 L 是不固定的（相对地址）。

大部分高级语言采用先编译后执行的方式，而有的高级语言则采用「解释」执行的方式。  
实际上，许多编译程序的构造与实现技术同样适用于解释程序。

根据不同的用途和侧重，编译程序还可进一步分类：

- 诊断编译器（Diagnostic Compiler)  
  专门帮助程序开发和调试。
- 优化编译器 (Optimizing Compiler)  
  着重于提高目标代码效率。
- 一遍编译器
- 多遍编译器
- 装入并执行编译器

现在很多编译程序同时提供了调试、优化等多种功能。

> 解释器是另一种常见的语言处理器。从用户角度看，解释器直接利用用户提供的输入执行源程序中指定的操作。  
> Java 结合了编译和解释的过程。首先将 Java 源程序编译为字节码，然后藉由虚拟机进行解释执行。

## 0.2 编译过程

> ![compilerFlow](../pic/compilerFlow.svg "编译流程")

可类比于自然语言的翻译，编程语言的编译分为以下过程：

- 词法分析  
  识别出句子的每个单词。
- 语法分析  
  分析句子的语法结构。
- 语义分析  
  分析句子的正确性。
- 中间代码产生  
  根据句子的含义进行初步翻译。
- 优化  
  对译文进行修饰。
- 目标代码生成  
  生成最终的译文。

除此之外，在自然语言中，还会出现作为对话共识的专有名词，或是二义性引发的误会。因此还需要以下过程：

- 符号表管理  
  管理标识符。标识符即用来指代其他事物的专有名词。
- 错误处理器

### 0.2.1 符号表管理

编译器的一个基本功能是记录源程序中使用的标识符并收集与每个标识符相关的各种属性信息。

标识符的属性信息长主要包含：

- 标识符的存储位置
- 类型
- 作用域

如果标识符是过程名时，它的属性信息还包括：

- 参数的个数与类型
- 每个参数的传递方法（传参？传值？）
- 返问值的类型

符号表是一个数据结构。每个标识符在符号表中都有一条记录，记录的每个域对应该标识符的属性。  
这种数据结构允许我们快速地找到每个标识符的记录，并在该记永中快速地存储和检索信息。

通常标识符的属性信息将由词法分析后的各阶段陆续写入符号表。

### 0.2.2 错误检测与报告

发现错误即停止运行的编译器不是一个好的编译器。

语法分析和语义分析阶段通常能够处理编译器所能检测到的大部分错误。

- 词法分析阶段能够检测出输入中不能形成源语言任何记号的错误字符串。
- 语法分析阶段可以确定记号流中违反源语言语法规则的错误。
- 语义分析阶段试图检测出具有正确的语法结构但对操作无意义的部分。

### 0.2.3 各分析阶段

![编译示例](../pic/compileExample.svg "编译示例")

**词法分析** (Lexical analysis) 阶段读入源程序中的字符流，并将这些字符组织成为有意义的词素 (Lexeme) 的序列。

词法分析器产生如下形式的词法单元 (token) 作为输出：`<token-name , attribute-value>`

**语法分析** (Syntax analysis) 阶段使用由此法分析器生成的各个词法单元的第一个分量来创建树形的中间表示。  
该中间表示给出了词法分析产生的词法单元流的语法结构。一般表示为 **语法树** (Syntax tree)。  

